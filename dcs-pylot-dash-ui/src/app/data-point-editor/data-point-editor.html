<!--
Copyright (c) 2025 Kevin Rzepka <kdev@posteo.com>
SPDX-License-Identifier: MIT
License-Filename: LICENSE
-->
<p-card>
  <ng-template #header>
    <div class="headerGroup">
      <p-iftalabel>
        <label for="inputDisplayName">Display Name</label>
        <input
          id="inputDisplayName"
          type="text"
          pInputText
          [pKeyFilter]="displayNameRegex"
          [maxlength]="displayNameMaxLength"
          [formControl]="fcDisplayName"
          pTooltip="Change the display name for this data point"
        />
      </p-iftalabel>
      <p-button
        icon="pi pi-trash"
        severity="danger"
        [pTooltip]="'Remove this data point'"
        (click)="deleteDataPoint()"
      />
    </div>
    <app-source-data-point-chooser
      [label]="'Source Data Point'"
      [tooltip]="'Change the source for this data point'"
      [initialValue]="dataPoint.sourceDataPoint"
      (onSourceDataPointChange)="handleSourceDataPointChange($event)"
    />
    <app-unit-chooser
      [dataPoint]="dataPoint"
      (onUnitChange)="handleUnitChange($event)"
      pTooltip="Change the output unit for this data point"
    />
    <div class="bottomButtons" #bottomButtons>
      <p-popover
        #colorScalePopover
        (onHide)="handleColorScalePopoverHidden($event)"
        [appendTo]="bottomButtons"
      >
        <app-color-scale-editor
          [dataPoint]="dataPoint"
          (colorScaleChanged)="handleColorScaleChanged($event)"
          (closeDesired)="colorScalePopover.hide()"
        ></app-color-scale-editor>
      </p-popover>

      <p-button
        #colorScaleButton
        icon="pi pi-palette"
        [severity]="colorScaleButtonSeverity$ | async"
        pTooltip="Edit color scale"
        (click)="colorScalePopover.show($event)"
      />
    </div>
  </ng-template>
</p-card>
