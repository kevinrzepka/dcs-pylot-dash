<!--
Copyright (c) 2026 Kevin Rzepka <kdev@posteo.com>
SPDX-License-Identifier: MIT
License-Filename: LICENSE
-->
<h4 class="header">
  Edit Color Scale of {{ dataPoint.displayName }}
  <p-button
    icon="pi pi-info"
    pTooltip="You don't have to specify both From and To values for each range. You could just specify only To or only From values. For values that are not covered by any of your defined ranges, the default color will be used. It's also ok to leave the last range empty, it's just there to add a new range if desired."
    severity="secondary"
    size="small"
    [rounded]="true"
    [disabled]="true"
  />
</h4>
@for (range of ranges; track range) {
  <div class="colorScaleRow">
    <p-button
      icon="pi pi-trash"
      severity="danger"
      pTooltip="Remove this range"
      (click)="removeRange(range)"
      [disabled]="$first"
    />
    <app-color-scale-entry
      [range]="range"
      [previousRange]="$index > 0 ? ranges[$index - 1] : null"
      [nextRange]="$index < ranges.length - 1 ? ranges[$index + 1] : null"
      (rangeChanged)="handleRangeChanged($event)"
    ></app-color-scale-entry>
  </div>
}
<div class="bottomControls">
  <p-button
    icon="pi pi-trash"
    severity="danger"
    pTooltip="Clear all ranges for this data point"
    (click)="clear()"
    [disabled]="!dataPoint.hasColorScale()"
    label="Clear"
  />
  <p-iftalabel>
    <p-autocomplete
      inputId="copyFromDataPoint"
      [formControl]="fcCopyFromDataPoint"
      [dropdown]="true"
      [forceSelection]="true"
      [suggestions]="copyFromDataPointSuggestions"
      (completeMethod)="searchDataPointsWithColorScale($event)"
      optionLabel="displayName"
    >
      <ng-template let-item #item>
        <div [style]="{ width: '100%' }">
          <span [innerText]="item.displayName"></span>
        </div>
      </ng-template>
    </p-autocomplete>
    <label for="inputSourceDataPoint">Copy from data point</label>
  </p-iftalabel>
  <p-button
    class="copyButton"
    icon="pi pi-copy"
    severity="secondary"
    pTooltip="Copy the color scale from the selected data point"
    (click)="copyFromSelectedDataPoint()"
    [disabled]="!fcCopyFromDataPoint.value"
    label="Copy"
  />
  <p-button
    class="applyButton"
    icon="pi pi-check"
    severity="secondary"
    pTooltip="Apply and close"
    (click)="apply()"
    label="Apply"
  />
</div>
